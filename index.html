<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scott & Melinda - Wedding Weekend</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --sand: #F5F1E8;
            --warm-gray: #9B8E7E;
            --dark-gray: #4A4238;
            --accent: #C9A882;
            --white: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--sand);
            color: var(--dark-gray);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: var(--white);
            box-shadow: 0 2px 10px rgba(74, 66, 56, 0.08);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
            text-align: center;
        }

        .header-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            font-weight: 300;
            color: var(--dark-gray);
            margin-bottom: 0.5rem;
            letter-spacing: 0.02em;
        }

        .header-subtitle {
            font-size: 0.9rem;
            color: var(--warm-gray);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        /* Navigation */
        .nav {
            background: var(--white);
            border-top: 1px solid rgba(155, 142, 126, 0.2);
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 0 1rem;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            font-family: 'Lato', sans-serif;
            font-size: 0.9rem;
            color: var(--warm-gray);
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.05em;
            border-bottom: 2px solid transparent;
        }

        .nav-tab:hover {
            color: var(--accent);
        }

        .nav-tab.active {
            color: var(--dark-gray);
            border-bottom-color: var(--accent);
        }

        /* Content Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.5rem;
            font-weight: 300;
            text-align: center;
            margin-bottom: 2rem;
            color: var(--dark-gray);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--warm-gray);
            font-style: italic;
        }

        /* Home Section */
        .welcome-box {
            background: var(--white);
            padding: 3rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }

        .welcome-text {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .event-date {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            color: var(--accent);
            margin: 1.5rem 0;
        }

        /* Schedule Section */
        .schedule-day {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
        }

        .day-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            color: var(--dark-gray);
            margin-bottom: 0.5rem;
        }

        .day-date {
            font-size: 0.9rem;
            color: var(--warm-gray);
            margin-bottom: 1.5rem;
            letter-spacing: 0.05em;
        }

        .event {
            padding: 1.5rem 0;
            border-top: 1px solid rgba(155, 142, 126, 0.2);
        }

        .event:first-child {
            border-top: none;
            padding-top: 0;
        }

        .event-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            color: var(--dark-gray);
            margin-bottom: 0.5rem;
        }

        .event-time {
            color: var(--accent);
            font-weight: 400;
            margin-bottom: 0.5rem;
        }

        .event-location {
            color: var(--warm-gray);
            font-style: italic;
            margin-bottom: 0.75rem;
        }

        .event-description {
            line-height: 1.7;
            margin-bottom: 0.5rem;
        }

        .event-attire {
            color: var(--warm-gray);
            font-size: 0.9rem;
            font-style: italic;
        }

        /* Map Section */
        .map-container {
            background: var(--white);
            padding: 2rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
            margin-bottom: 2rem;
        }

        .map-svg {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            display: block;
        }

        .map-location {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .map-location:hover .location-shape {
            fill: var(--accent);
            opacity: 0.3;
        }

        .map-location.active .location-shape {
            fill: var(--accent);
            opacity: 0.4;
        }

        .location-shape {
            fill: var(--sand);
            stroke: var(--warm-gray);
            stroke-width: 2;
            opacity: 0.2;
        }

        .location-label {
            font-size: 12px;
            fill: var(--dark-gray);
            pointer-events: none;
        }

        .event-details-box {
            background: var(--sand);
            padding: 1.5rem;
            border-radius: 2px;
            margin-top: 2rem;
            min-height: 100px;
            text-align: center;
        }

        .event-details-box.empty {
            color: var(--warm-gray);
            font-style: italic;
        }

        /* Travel & FAQ */
        .info-box {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
        }

        .info-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            color: var(--dark-gray);
            margin-bottom: 1rem;
        }

        .info-text {
            line-height: 1.7;
            margin-bottom: 1rem;
            white-space: pre-line;
        }

        .info-text strong {
            color: var(--accent);
        }

        /* FAQ Accordion */
        .faq-section-header {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            color: var(--dark-gray);
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(155, 142, 126, 0.2);
        }

        .faq-item {
            background: var(--white);
            margin-bottom: 0.75rem;
            border-radius: 2px;
            box-shadow: 0 2px 10px rgba(74, 66, 56, 0.08);
            overflow: hidden;
        }

        .faq-question {
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
            user-select: none;
        }

        .faq-question:hover {
            background: var(--sand);
        }

        .faq-question-text {
            font-weight: 400;
            color: var(--dark-gray);
            flex: 1;
        }

        .faq-icon {
            color: var(--accent);
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            margin-left: 1rem;
        }

        .faq-item.open .faq-icon {
            transform: rotate(90deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .faq-answer-content {
            padding: 0 1.5rem 1.25rem 1.5rem;
            line-height: 1.7;
            color: var(--dark-gray);
            white-space: pre-line;
        }

        .faq-item.open .faq-answer {
            max-height: 1000px;
        }

        /* Seating Chart Styles */
        .search-section {
            background: var(--white);
            padding: 2rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
            margin-bottom: 2rem;
        }

        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }

        input[type="text"] {
            width: 100%;
            padding: 1rem 1.25rem;
            font-size: 1rem;
            font-family: 'Lato', sans-serif;
            border: 1px solid var(--warm-gray);
            background: var(--white);
            color: var(--dark-gray);
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(201, 168, 130, 0.1);
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--white);
            border: 1px solid var(--warm-gray);
            border-top: none;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(74, 66, 56, 0.15);
            display: none;
        }

        .autocomplete-dropdown.show {
            display: block;
        }

        .autocomplete-item {
            padding: 0.875rem 1.25rem;
            cursor: pointer;
            transition: background 0.2s ease;
            border-bottom: 1px solid rgba(155, 142, 126, 0.1);
        }

        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background: var(--sand);
        }

        .result {
            padding: 1.5rem;
            background: var(--sand);
            border-radius: 2px;
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .result-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            color: var(--dark-gray);
            font-weight: 400;
        }

        .result-detail {
            font-size: 0.9rem;
            color: var(--warm-gray);
            margin-top: 0.5rem;
        }

        .diagram-section {
            background: var(--white);
            padding: 2rem;
            border-radius: 2px;
            box-shadow: 0 2px 20px rgba(74, 66, 56, 0.08);
        }

        .venue-layout {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
        }

        .section-overlay {
            fill: transparent;
            stroke: none;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s ease;
        }

        .section-overlay.highlight {
            fill: var(--accent);
            opacity: 0.4;
            stroke: var(--accent);
            stroke-width: 2;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-title {
                font-size: 1.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .nav-tab {
                padding: 0.75rem 1rem;
                font-size: 0.85rem;
            }

            .container {
                padding: 2rem 1rem;
            }

            .welcome-box,
            .schedule-day,
            .map-container,
            .info-box {
                padding: 1.5rem;
            }
        }

        /* Photo Gallery Styles */
        .gallery-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
        }

        .gallery-row {
            display: flex;
            gap: 4px;
            width: 100%;
            margin-bottom: 4px;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-grow: 1;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .gallery-item:hover {
            opacity: 0.9;
        }

        .gallery-item:hover img {
            transform: scale(1.05);
        }

        /* Lightbox Styles */
        .lightbox {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            overflow: hidden;
        }

        .lightbox.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lightbox-content {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            animation: fadeIn 0.3s;
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10000;
        }

        .lightbox-close:hover,
        .lightbox-close:focus {
            color: #bbb;
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            font-size: 30px;
            padding: 20px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10000;
        }

        .lightbox-nav:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .lightbox-prev {
            left: 20px;
        }

        .lightbox-next {
            right: 20px;
        }

        .lightbox-caption {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #f1f1f1;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 10000;
        }

        @media (max-width: 768px) {
            .lightbox-content {
                max-width: 95%;
                max-height: 80%;
            }

            .lightbox-nav {
                font-size: 24px;
                padding: 15px 10px;
            }

            .lightbox-prev {
                left: 10px;
            }

            .lightbox-next {
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <h1 class="header-title">Scott & Melinda</h1>
            <p class="header-subtitle">January 31, 2026 Â· Conrad Punta de Mita</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <button class="nav-tab active" onclick="showSection('home')">Home</button>
            <button class="nav-tab" onclick="showSection('schedule')">Schedule</button>
            <button class="nav-tab" onclick="showSection('map')">Map</button>
            <button class="nav-tab" onclick="showSection('seating')">Seating</button>
            <button class="nav-tab" onclick="showSection('photos')">Photos</button>
            <button class="nav-tab" onclick="showSection('travel')">Travel</button>
            <button class="nav-tab" onclick="showSection('faq')">FAQ</button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- HOME SECTION -->
        <section id="home" class="section active">
            <div id="home-loading" class="loading">Loading...</div>
            <div id="home-content" style="display: none;"></div>
        </section>

        <!-- SCHEDULE SECTION -->
        <section id="schedule" class="section">
            <h2 class="section-title">Weekend Schedule</h2>
            <div id="schedule-loading" class="loading">Loading schedule...</div>
            <div id="schedule-content"></div>
        </section>

        <!-- MAP SECTION -->
        <section id="map" class="section">
            <h2 class="section-title">Resort Map</h2>
            <div class="map-container">
                <p style="text-align: center; color: var(--warm-gray); margin-bottom: 1.5rem;">Click on a location to see event details</p>
                
                <svg class="map-svg" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                    <!-- Beach at bottom -->
                    <rect x="0" y="500" width="800" height="100" fill="#E8DCC8" opacity="0.3"/>
                    <text x="400" y="560" text-anchor="middle" font-size="14" fill="var(--warm-gray)" opacity="0.6">Beach</text>
                    
                    <!-- Main hotel building -->
                    <rect x="150" y="50" width="500" height="200" fill="var(--white)" stroke="var(--warm-gray)" stroke-width="2"/>
                    <text x="400" y="145" text-anchor="middle" font-size="16" fill="var(--dark-gray)">Conrad Punta de Mita</text>
                    <text x="400" y="165" text-anchor="middle" font-size="12" fill="var(--warm-gray)">Main Hotel</text>
                    
                    <!-- Activity Pool (by Mezquite) - Left side -->
                    <g class="map-location" data-location="activity-pool">
                        <ellipse class="location-shape" cx="200" cy="350" rx="70" ry="50"/>
                        <text class="location-label" x="200" y="340" text-anchor="middle" font-weight="600">Activity Pool</text>
                        <text class="location-label" x="200" y="355" text-anchor="middle" font-size="10">(by Mezquite)</text>
                        <text class="location-label" x="200" y="368" text-anchor="middle" font-size="10" fill="var(--accent)">Pool Day</text>
                    </g>
                    
                    <!-- Aura - Center -->
                    <g class="map-location" data-location="aura">
                        <rect class="location-shape" x="340" y="280" width="120" height="80" rx="3"/>
                        <text class="location-label" x="400" y="315" text-anchor="middle" font-weight="600">Aura</text>
                        <text class="location-label" x="400" y="332" text-anchor="middle" font-size="10" fill="var(--accent)">Welcome Dinner</text>
                    </g>
                    
                    <!-- Codex - Right side by beach -->
                    <g class="map-location" data-location="codex">
                        <rect class="location-shape" x="520" y="320" width="140" height="120" rx="3"/>
                        <text class="location-label" x="590" y="370" text-anchor="middle" font-weight="600">Codex</text>
                        <text class="location-label" x="590" y="387" text-anchor="middle" font-size="10" fill="var(--accent)">Wedding</text>
                        <text class="location-label" x="590" y="401" text-anchor="middle" font-size="10" fill="var(--accent)">Ceremony & Reception</text>
                    </g>
                    
                    <!-- Tuki Patio - Left side, upper -->
                    <g class="map-location" data-location="tuki">
                        <rect class="location-shape" x="70" y="120" width="100" height="70" rx="3"/>
                        <text class="location-label" x="120" y="150" text-anchor="middle" font-weight="600">Tuki Patio</text>
                        <text class="location-label" x="120" y="167" text-anchor="middle" font-size="10" fill="var(--accent)">Farewell Brunch</text>
                    </g>
                </svg>

                <div id="event-details" class="event-details-box empty">
                    Click a location above to see event details
                </div>
            </div>
        </section>

        <!-- SEATING SECTION -->
        <section id="seating" class="section">
            <h2 class="section-title">Find Your Seat</h2>
            
            <div class="search-section">
                <div class="search-box">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Enter your name..."
                        autocomplete="off"
                    >
                    <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
                </div>
                <div class="result" id="result">
                    <div class="result-detail">Search for your name to find your seat</div>
                </div>
            </div>

            <div class="diagram-section">
                <div class="venue-layout" id="venueDiagram">
                    <svg viewBox="0 0 800 350" xmlns="http://www.w3.org/2000/svg">
                        <!-- Sweetheart Table -->
                        <g id="sweetheart-group">
                            <text x="55" y="140" class="location-label" style="font-size: 10px; opacity: 0.6;">Sweetheart</text>
                            <rect class="section-overlay" id="sweetheart" x="30" y="150" width="50" height="80" rx="3"/>
                            <rect x="30" y="150" width="50" height="80" rx="3" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                        </g>
                        
                        <!-- Table 1 -->
                        <g id="table1-group">
                            <text x="450" y="15" class="location-label" style="font-size: 11px; opacity: 0.6;">Table 1</text>
                            
                            <rect class="section-overlay" id="section-1-A" x="120" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-B" x="200" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-C" x="280" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-D" x="360" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-E" x="440" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-F" x="520" y="50" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-1-G" x="600" y="50" width="80" height="80" rx="3"/>
                            
                            <rect x="120" y="50" width="560" height="80" rx="3" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <line x1="200" y1="50" x2="200" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="280" y1="50" x2="280" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="360" y1="50" x2="360" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="440" y1="50" x2="440" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="520" y1="50" x2="520" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="600" y1="50" x2="600" y2="130" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <text x="160" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">A</text>
                            <text x="240" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">B</text>
                            <text x="320" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">C</text>
                            <text x="400" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">D</text>
                            <text x="480" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">E</text>
                            <text x="560" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">F</text>
                            <text x="640" y="95" class="location-label" style="font-size: 12px; opacity: 0.4;">G</text>
                            
                            <!-- Chairs (simplified for brevity - top row) -->
                            <rect x="130" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="172" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="210" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="252" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="290" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="332" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="370" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="412" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="450" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="492" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="530" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="572" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="610" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="652" y="28" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <!-- Bottom row -->
                            <rect x="130" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="172" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="210" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="252" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="290" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="332" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="370" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="412" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="450" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="492" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="530" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="572" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="610" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="652" y="134" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                        </g>
                        
                        <!-- Table 2 -->
                        <g id="table2-group">
                            <text x="450" y="175" class="location-label" style="font-size: 11px; opacity: 0.6;">Table 2</text>
                            
                            <rect class="section-overlay" id="section-2-A" x="120" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-B" x="200" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-C" x="280" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-D" x="360" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-E" x="440" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-F" x="520" y="210" width="80" height="80" rx="3"/>
                            <rect class="section-overlay" id="section-2-G" x="600" y="210" width="80" height="80" rx="3"/>
                            
                            <rect x="120" y="210" width="560" height="80" rx="3" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <line x1="200" y1="210" x2="200" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="280" y1="210" x2="280" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="360" y1="210" x2="360" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="440" y1="210" x2="440" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="520" y1="210" x2="520" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <line x1="600" y1="210" x2="600" y2="290" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <text x="160" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">A</text>
                            <text x="240" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">B</text>
                            <text x="320" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">C</text>
                            <text x="400" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">D</text>
                            <text x="480" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">E</text>
                            <text x="560" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">F</text>
                            <text x="640" y="255" class="location-label" style="font-size: 12px; opacity: 0.4;">G</text>
                            
                            <!-- Top row chairs -->
                            <rect x="130" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="172" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="210" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="252" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="290" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="332" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="370" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="412" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="450" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="492" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="530" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="572" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="610" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="652" y="188" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            
                            <!-- Bottom row -->
                            <rect x="130" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="172" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="210" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="252" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="290" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="332" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="370" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="412" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="450" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="492" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="530" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="572" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="610" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                            <rect x="652" y="294" width="18" height="18" rx="2" fill="none" stroke="var(--warm-gray)" stroke-width="1.5"/>
                        </g>
                    </svg>
                </div>
            </div>
        </section>

        <!-- PHOTOS SECTION -->
        <section id="photos" class="section">
            <h2 class="section-title">Wedding Weekend Photos</h2>
            
            <div class="welcome-box" style="margin-bottom: 2rem;">
                <p class="welcome-text" style="font-size: 1rem; margin-bottom: 1rem;">
                    We'd love to see your photos from the entire weekend - not just the wedding ceremony! Pool days, dinners, candid moments, and everything in between.
                </p>
                <p class="welcome-text" style="font-size: 0.9rem; color: var(--warm-gray); margin-bottom: 1.5rem;">
                    Please keep all photos tasteful.
                </p>
                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="https://drive.google.com/drive/folders/1abaI_-Rf1HMO6cnuo4bfjvbks72zaC4E" target="_blank" style="
                        display: inline-block;
                        padding: 1rem 2rem;
                        background: var(--accent);
                        color: var(--white);
                        text-decoration: none;
                        border-radius: 2px;
                        font-weight: 400;
                        transition: all 0.3s ease;
                        letter-spacing: 0.05em;
                    " onmouseover="this.style.background='var(--dark-gray)'" onmouseout="this.style.background='var(--accent)'">
                        ðŸ“¸ Upload Your Photos
                    </a>
                </div>
            </div>

            <!-- Photo Gallery -->
            <div id="photo-gallery-loading" class="loading">Loading photos...</div>
            <div id="photo-gallery" style="display: none;">
                <div id="gallery-grid" class="gallery-grid"></div>
            </div>

            <!-- Lightbox -->
            <div id="lightbox" class="lightbox">
                <span class="lightbox-close">&times;</span>
                <img class="lightbox-content" id="lightbox-img">
                <div class="lightbox-caption" id="lightbox-caption"></div>
                <button class="lightbox-nav lightbox-prev">&#10094;</button>
                <button class="lightbox-nav lightbox-next">&#10095;</button>
            </div>
        </section>

        <!-- TRAVEL SECTION -->
        <section id="travel" class="section">
            <h2 class="section-title">Travel Information</h2>
            <div id="travel-loading" class="loading">Loading travel information...</div>
            <div id="travel-content"></div>
        </section>

        <!-- FAQ SECTION -->
        <section id="faq" class="section">
            <h2 class="section-title">FAQ</h2>
            <div id="faq-loading" class="loading">Loading FAQ...</div>
            <div id="faq-content"></div>
        </section>
    </div>

    <script>
        // CONFIGURATION - Google Sheet URLs
        const SHEET_BASE_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTnii7jdJ1CNlEotrqzCs1nQRv7OR2iT7nqeyCYem0wRXGCL4RRKC8Awr-M963Nr18Xr4j2J71WV5vd/pub';
        const SHEETS = {
            seating: `${SHEET_BASE_URL}?gid=1863066982&single=true&output=csv`,
            schedule: `${SHEET_BASE_URL}?gid=1814110480&single=true&output=csv`,
            faq: `${SHEET_BASE_URL}?gid=1666160613&single=true&output=csv`,
            travel: `${SHEET_BASE_URL}?gid=93860544&single=true&output=csv`,
            mapEvents: `${SHEET_BASE_URL}?gid=1344707168&single=true&output=csv`,
            home: `${SHEET_BASE_URL}?gid=895216545&single=true&output=csv`
        };

        // CSV Parser - Enhanced to handle multi-line cells with quotes
        function parseCSV(csvText) {
            const lines = [];
            let currentLine = '';
            let inQuotes = false;
            
            // First, split into lines while respecting quotes
            for (let i = 0; i < csvText.length; i++) {
                const char = csvText[i];
                const nextChar = csvText[i + 1];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                    currentLine += char;
                } else if (char === '\n' && !inQuotes) {
                    if (currentLine.trim()) {
                        lines.push(currentLine);
                    }
                    currentLine = '';
                } else {
                    currentLine += char;
                }
            }
            
            // Don't forget the last line
            if (currentLine.trim()) {
                lines.push(currentLine);
            }
            
            if (lines.length === 0) return [];
            
            // Parse header
            const headers = parseCSVLine(lines[0]);
            
            // Parse data rows
            return lines.slice(1).map(line => {
                const values = parseCSVLine(line);
                const obj = {};
                headers.forEach((header, i) => {
                    obj[header] = values[i] || '';
                });
                return obj;
            });
        }
        
        // Helper function to parse a single CSV line
        function parseCSVLine(line) {
            const values = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        // Escaped quote
                        current += '"';
                        i++; // Skip next quote
                    } else {
                        // Toggle quote state
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    values.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            values.push(current.trim());
            return values;
        }

        // Load Home Page
        async function loadHome() {
            try {
                const response = await fetch(SHEETS.home);
                const csvText = await response.text();
                const data = parseCSV(csvText);
                
                const homeContent = document.getElementById('home-content');
                const content = {};
                data.forEach(row => {
                    content[row.Section] = row.Content;
                });
                
                homeContent.innerHTML = `
                    <h2 class="section-title">${content['Title'] || 'Welcome to Our Wedding Weekend'}</h2>
                    <div class="welcome-box">
                        <p class="welcome-text">${content['Paragraph 1'] || ''}</p>
                        <div class="event-date">${content['Subtitle'] || 'January 29 - February 1, 2026'}</div>
                        <p class="welcome-text">${content['Paragraph 2'] || ''}</p>
                    </div>
                `;
                
                document.getElementById('home-loading').style.display = 'none';
                homeContent.style.display = 'block';
            } catch (error) {
                console.error('Error loading home:', error);
                document.getElementById('home-loading').textContent = 'Error loading content. Please refresh the page.';
            }
        }

        // Load Schedule
        async function loadSchedule() {
            try {
                const response = await fetch(SHEETS.schedule);
                const csvText = await response.text();
                const events = parseCSV(csvText).sort((a, b) => parseInt(a.Order) - parseInt(b.Order));
                
                const scheduleContent = document.getElementById('schedule-content');
                const groupedByDay = {};
                
                events.forEach(event => {
                    if (!groupedByDay[event.Day]) {
                        groupedByDay[event.Day] = {
                            date: event.Date,
                            events: []
                        };
                    }
                    groupedByDay[event.Day].events.push(event);
                });
                
                scheduleContent.innerHTML = Object.entries(groupedByDay).map(([day, data]) => `
                    <div class="schedule-day">
                        <h3 class="day-title">${day}</h3>
                        <p class="day-date">${data.date}</p>
                        ${data.events.map(event => `
                            <div class="event">
                                <div class="event-name">${event['Event Name']}</div>
                                <div class="event-time">${event.Time}</div>
                                ${event.Location ? `<div class="event-location">${event.Location}</div>` : ''}
                                ${event.Description ? `<div class="event-description">${event.Description}</div>` : ''}
                                ${event.Attire ? `<div class="event-attire">Attire: ${event.Attire}</div>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `).join('');
                
                document.getElementById('schedule-loading').style.display = 'none';
            } catch (error) {
                console.error('Error loading schedule:', error);
                document.getElementById('schedule-loading').textContent = 'Error loading schedule. Please refresh the page.';
            }
        }

        // Load Map Events
        let mapEventData = {};
        async function loadMapEvents() {
            try {
                const response = await fetch(SHEETS.mapEvents);
                const csvText = await response.text();
                const events = parseCSV(csvText);
                
                events.forEach(event => {
                    mapEventData[event['Location ID']] = {
                        name: event['Event Name'],
                        time: event.Time,
                        location: event['Location Name'],
                        description: event.Description,
                        attire: event.Attire
                    };
                });
            } catch (error) {
                console.error('Error loading map events:', error);
            }
        }

        // Load Travel
        async function loadTravel() {
            try {
                const response = await fetch(SHEETS.travel);
                const csvText = await response.text();
                const data = parseCSV(csvText);
                
                const travelContent = document.getElementById('travel-content');
                const content = {};
                data.forEach(row => {
                    content[row.Section] = row.Content;
                });
                
                travelContent.innerHTML = `
                    <div class="info-box">
                        <h3 class="info-title">Getting There</h3>
                        <p class="info-text">
                            <strong>Airport:</strong> ${content['Airport'] || ''}<br><br>
                            ${content['Airport Details'] || ''}
                        </p>
                    </div>

                    <div class="info-box">
                        <h3 class="info-title">Hotel Information</h3>
                        <p class="info-text">
                            <strong>${content['Hotel Name'] || ''}</strong><br>
                            ${content['Hotel Address'] || ''}<br><br>
                            ${content['Booking Info'] || ''}<br>
                            <strong>Email:</strong> ${content['Booking Email'] || ''}<br>
                            <strong>Phone:</strong> ${content['Booking Phone'] || ''}<br><br>
                            <strong>Recommended Dates:</strong> ${content['Recommended Dates'] || ''}
                        </p>
                    </div>
                `;
                
                document.getElementById('travel-loading').style.display = 'none';
            } catch (error) {
                console.error('Error loading travel:', error);
                document.getElementById('travel-loading').textContent = 'Error loading travel info. Please refresh the page.';
            }
        }

        // Load FAQ with Accordion
        async function loadFAQ() {
            try {
                const response = await fetch(SHEETS.faq);
                const csvText = await response.text();
                const faqs = parseCSV(csvText)
                    .filter(faq => faq.Question && faq.Question.trim()) // Only include rows with questions
                    .sort((a, b) => parseInt(a.Order) - parseInt(b.Order));
                
                const faqContent = document.getElementById('faq-content');
                const groupedBySection = {};
                
                faqs.forEach(faq => {
                    if (!groupedBySection[faq.Section]) {
                        groupedBySection[faq.Section] = [];
                    }
                    groupedBySection[faq.Section].push(faq);
                });
                
                faqContent.innerHTML = Object.entries(groupedBySection).map(([section, items]) => `
                    <div class="faq-section-header">${section}</div>
                    ${items.map((faq, index) => `
                        <div class="faq-item" id="faq-${section.replace(/\s+/g, '-')}-${index}">
                            <div class="faq-question" onclick="toggleFAQ('${section.replace(/\s+/g, '-')}-${index}')">
                                <span class="faq-question-text">${faq.Question}</span>
                                <span class="faq-icon">â–¶</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${faq.Answer}</div>
                            </div>
                        </div>
                    `).join('')}
                `).join('');
                
                document.getElementById('faq-loading').style.display = 'none';
            } catch (error) {
                console.error('Error loading FAQ:', error);
                document.getElementById('faq-loading').textContent = 'Error loading FAQ. Please refresh the page.';
            }
        }

        // Toggle FAQ Item
        function toggleFAQ(id) {
            const item = document.getElementById(`faq-${id}`);
            item.classList.toggle('open');
        }

        // Photo Gallery Functions
        const DRIVE_FOLDER_ID = '1abaI_-Rf1HMO6cnuo4bfjvbks72zaC4E';
        let allPhotos = [];
        let currentPhotoIndex = 0;

        async function loadPhotoGallery() {
            try {
                // Fetch photos from Google Drive folder
                const apiKey = 'AIzaSyAYrXPbdenTOfuVDhcaY1oDBGit1pb2mfg';
                const url = `https://www.googleapis.com/drive/v3/files?q='${DRIVE_FOLDER_ID}'+in+parents+and+mimeType+contains+'image/'&fields=files(id,name,thumbnailLink,webContentLink,createdTime)&orderBy=createdTime+desc&key=${apiKey}`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (!data.files || data.files.length === 0) {
                    document.getElementById('photo-gallery-loading').textContent = 'No photos yet. Check back soon!';
                    return;
                }
                
                allPhotos = data.files;
                renderJustifiedGallery(allPhotos);
                
                document.getElementById('photo-gallery-loading').style.display = 'none';
                document.getElementById('photo-gallery').style.display = 'block';
                
            } catch (error) {
                console.error('Error loading photos:', error);
                document.getElementById('photo-gallery-loading').textContent = 'Error loading photos. Please refresh the page.';
            }
        }

        function renderJustifiedGallery(photos) {
            const container = document.getElementById('gallery-grid');
            container.innerHTML = '';
            
            // Justified layout settings
            const targetRowHeight = 250;
            const containerWidth = container.offsetWidth || 1000;
            const spacing = 4;
            
            let currentRow = [];
            let currentRowWidth = 0;
            
            photos.forEach((photo, index) => {
                // Assume 16:9 ratio for photos (will be adjusted with actual dimensions)
                const aspectRatio = 1.5;
                const photoWidth = targetRowHeight * aspectRatio;
                
                currentRow.push({ photo, index, width: photoWidth });
                currentRowWidth += photoWidth + spacing;
                
                // Check if row is full
                if (currentRowWidth >= containerWidth || index === photos.length - 1) {
                    renderRow(currentRow, containerWidth, targetRowHeight, container);
                    currentRow = [];
                    currentRowWidth = 0;
                }
            });
        }

        function renderRow(rowPhotos, containerWidth, targetHeight, container) {
            if (rowPhotos.length === 0) return;
            
            const row = document.createElement('div');
            row.className = 'gallery-row';
            
            // Calculate total width needed
            const totalWidth = rowPhotos.reduce((sum, item) => sum + item.width, 0);
            const spacing = 4 * (rowPhotos.length - 1);
            const scale = (containerWidth - spacing) / totalWidth;
            
            rowPhotos.forEach(({ photo, index, width }) => {
                const scaledWidth = width * scale;
                const scaledHeight = targetHeight * scale;
                
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.style.width = `${scaledWidth}px`;
                item.style.height = `${scaledHeight}px`;
                
                const img = document.createElement('img');
                // Use thumbnail for gallery, webContentLink for lightbox
                img.src = photo.thumbnailLink || `https://drive.google.com/uc?export=view&id=${photo.id}`;
                img.alt = photo.name;
                img.loading = 'lazy';
                
                item.appendChild(img);
                item.onclick = () => openLightbox(index);
                
                row.appendChild(item);
            });
            
            container.appendChild(row);
        }

        // Lightbox Functions
        function openLightbox(index) {
            currentPhotoIndex = index;
            showPhoto(index);
            document.getElementById('lightbox').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showPhoto(index) {
            if (index < 0) index = allPhotos.length - 1;
            if (index >= allPhotos.length) index = 0;
            
            currentPhotoIndex = index;
            const photo = allPhotos[index];
            
            const img = document.getElementById('lightbox-img');
            const caption = document.getElementById('lightbox-caption');
            
            img.src = `https://drive.google.com/uc?export=view&id=${photo.id}`;
            caption.textContent = photo.name;
        }

        function nextPhoto() {
            showPhoto(currentPhotoIndex + 1);
        }

        function prevPhoto() {
            showPhoto(currentPhotoIndex - 1);
        }

        // Lightbox event listeners
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelector('.lightbox-close').onclick = closeLightbox;
            document.querySelector('.lightbox-next').onclick = nextPhoto;
            document.querySelector('.lightbox-prev').onclick = prevPhoto;
            
            // Close on background click
            document.getElementById('lightbox').onclick = (e) => {
                if (e.target.id === 'lightbox') {
                    closeLightbox();
                }
            };
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (!document.getElementById('lightbox').classList.contains('active')) return;
                
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowLeft') prevPhoto();
                if (e.key === 'ArrowRight') nextPhoto();
            });
        });

        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Map Interaction
        document.querySelectorAll('.map-location').forEach(location => {
            location.addEventListener('click', function() {
                const locationKey = this.dataset.location;
                const event = mapEventData[locationKey];
                
                if (!event) return;
                
                document.querySelectorAll('.map-location').forEach(loc => {
                    loc.classList.remove('active');
                });
                
                this.classList.add('active');
                
                const detailsBox = document.getElementById('event-details');
                detailsBox.classList.remove('empty');
                detailsBox.innerHTML = `
                    <div class="event-name" style="font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; margin-bottom: 0.5rem;">${event.name}</div>
                    <div class="event-time" style="color: var(--accent); margin-bottom: 0.5rem;">${event.time}</div>
                    <div class="event-location" style="color: var(--warm-gray); font-style: italic; margin-bottom: 0.75rem;">${event.location}</div>
                    <div class="event-description" style="margin-bottom: 0.5rem;">${event.description}</div>
                    <div class="event-attire" style="color: var(--warm-gray); font-size: 0.9rem; font-style: italic;">Attire: ${event.attire}</div>
                `;
            });
        });

        // Seating Chart (keeping existing logic but using new sheet reference)
        let guestData = [];

        async function loadGuestData() {
            try {
                const response = await fetch(SHEETS.seating);
                if (!response.ok) throw new Error('Failed to load');
                
                const csvText = await response.text();
                guestData = parseCSV(csvText).filter(guest => guest['Guest Name'] || guest.name || guest.Name);
                
                // Normalize column names to match what the code expects
                guestData = guestData.map(g => ({
                    name: g['Guest Name'] || g.name || g.Name || '',
                    table: g.Table || g.table || '',
                    section: g.Section || g.section || '',
                    coupleId: g['Couple ID'] || g.coupleId || g.couple_ID || g['couple_ID'] || '',
                    notes: g.Notes || g.notes || ''
                }));
                    
            } catch (error) {
                console.error('Error loading guest data:', error);
            }
        }

        const searchInput = document.getElementById('searchInput');
        const resultDiv = document.getElementById('result');
        const autocompleteDropdown = document.getElementById('autocompleteDropdown');
        let matchingGuests = [];

        function showGuestSeating(guest) {
            document.querySelectorAll('.section-overlay').forEach(el => {
                el.classList.remove('highlight');
            });

            const tableText = guest.table === 'Sweetheart' 
                ? 'Sweetheart Table'
                : `Table ${guest.table}-${guest.section}`;
            
            let seatedWith = '';
            if (guest.coupleId && guest.coupleId !== '') {
                const companions = guestData.filter(g => 
                    g.coupleId === guest.coupleId && 
                    g.name.toLowerCase() !== guest.name.toLowerCase()
                );
                
                if (companions.length > 0) {
                    seatedWith = `with ${companions.map(c => c.name).join(', ')}`;
                }
            }
            
            resultDiv.innerHTML = `
                <div class="result-text">${tableText}</div>
                <div class="result-detail">${seatedWith || guest.notes || 'See you there!'}</div>
            `;

            if (guest.table === 'Sweetheart') {
                document.getElementById('sweetheart')?.classList.add('highlight');
            } else {
                const sectionId = `section-${guest.table}-${guest.section}`;
                document.getElementById(sectionId)?.classList.add('highlight');
            }
        }

        function updateAutocomplete(searchTerm) {
            if (searchTerm.length < 2) {
                autocompleteDropdown.classList.remove('show');
                matchingGuests = [];
                return;
            }

            matchingGuests = guestData.filter(g => 
                g.name.toLowerCase().includes(searchTerm.toLowerCase())
            );

            if (matchingGuests.length === 0) {
                autocompleteDropdown.classList.remove('show');
                return;
            }

            autocompleteDropdown.innerHTML = matchingGuests.map((guest, index) => `
                <div class="autocomplete-item" data-index="${index}">
                    ${guest.name}
                </div>
            `).join('');

            autocompleteDropdown.classList.add('show');
        }

        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.trim();
            
            document.querySelectorAll('.section-overlay').forEach(el => {
                el.classList.remove('highlight');
            });

            if (searchTerm.length < 2) {
                resultDiv.innerHTML = '<div class="result-detail">Search for your name to find your seat</div>';
                updateAutocomplete(searchTerm);
                return;
            }

            updateAutocomplete(searchTerm);

            if (matchingGuests.length === 1) {
                showGuestSeating(matchingGuests[0]);
            } else if (matchingGuests.length === 0) {
                resultDiv.innerHTML = '<div class="result-detail">No match found. Try entering your full name.</div>';
            } else {
                resultDiv.innerHTML = '<div class="result-detail">Select your name from the list above</div>';
            }
        });

        autocompleteDropdown.addEventListener('click', (e) => {
            const item = e.target.closest('.autocomplete-item');
            if (item) {
                const index = parseInt(item.dataset.index);
                searchInput.value = matchingGuests[index].name;
                autocompleteDropdown.classList.remove('show');
                showGuestSeating(matchingGuests[index]);
            }
        });

        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target) && !autocompleteDropdown.contains(e.target)) {
                autocompleteDropdown.classList.remove('show');
            }
        });

        // Initialize
        async function init() {
            await Promise.all([
                loadHome(),
                loadSchedule(),
                loadMapEvents(),
                loadTravel(),
                loadFAQ(),
                loadGuestData(),
                loadPhotoGallery()
            ]);
        }

        init();
    </script>
</body>
</html>
